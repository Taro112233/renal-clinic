# üìã Project Instruction: ‡∏£‡∏∞‡∏ö‡∏ö‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÅ‡∏•‡∏∞‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏ö‡∏£‡∏¥‡∏ö‡∏≤‡∏•‡πÄ‡∏†‡∏™‡∏±‡∏ä‡∏Å‡∏£‡∏£‡∏°‡∏Ñ‡∏•‡∏¥‡∏ô‡∏¥‡∏Å‡πÇ‡∏£‡∏Ñ‡∏Ç‡πâ‡∏≠‡∏£‡∏π‡∏°‡∏≤‡∏ï‡∏¥‡∏ã‡∏±‡∏°
‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏°‡∏ö‡∏π‡∏£‡∏ì‡πå‡∏Ç‡∏≠‡∏á Instruction: 50%
‡∏Ç‡∏ì‡∏∞‡∏ô‡∏µ‡πâ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ó‡∏≥‡∏™‡πà‡∏ß‡∏ô‡∏Ç‡∏≠‡∏á: Dashboard ‡∏´‡∏•‡∏±‡∏á‡∏à‡∏≤‡∏Å login ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à ‡πÅ‡∏•‡∏∞ ‡∏´‡∏ô‡πâ‡∏≤‡∏£‡∏≠‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥

## Rheumatology Pharmaceutical Care Recording & Reporting System

---

## 1. üéØ Project Overview

### ‡∏ä‡∏∑‡πà‡∏≠‡∏£‡∏∞‡∏ö‡∏ö
**RheuPharmCare** ‚Äî ‡∏£‡∏∞‡∏ö‡∏ö‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡∏ö‡∏£‡∏¥‡∏ö‡∏≤‡∏•‡πÄ‡∏†‡∏™‡∏±‡∏ä‡∏Å‡∏£‡∏£‡∏° (Pharmaceutical Care) ‡∏Ñ‡∏•‡∏¥‡∏ô‡∏¥‡∏Å‡πÇ‡∏£‡∏Ñ‡∏Ç‡πâ‡∏≠‡∏£‡∏π‡∏°‡∏≤‡∏ï‡∏¥‡∏ã‡∏±‡∏° (Rheumatology Clinic)

### Pain Point ‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô
1. ‡πÄ‡∏†‡∏™‡∏±‡∏ä‡∏Å‡∏£‡∏à‡∏î‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• Pre-counseling ‡∏•‡∏á‡∏Å‡∏£‡∏∞‡∏î‡∏≤‡∏© ‚Üí ‡∏ï‡πâ‡∏≠‡∏á‡∏°‡∏≤‡∏Ñ‡∏µ‡∏¢‡πå‡∏ã‡πâ‡∏≥‡∏•‡∏á Google Spreadsheet
2. ‡∏™‡∏£‡∏∏‡∏õ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏ú‡∏•‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡πÇ‡∏î‡∏¢ manual: filter, ‡∏ô‡∏±‡∏ö‡∏°‡∏∑‡∏≠, ‡∏ú‡∏π‡∏Å pivot table ‡πÅ‡∏ö‡∏ö‡∏°‡∏±‡πà‡∏ß‡πÜ
3. ‡πÑ‡∏°‡πà‡∏°‡∏µ Dashboard / KPI ‡πÅ‡∏ö‡∏ö real-time
4. ‡πÄ‡∏™‡∏µ‡∏¢‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏≥‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏™‡πà‡∏á‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏á‡∏≤‡∏ô‡∏ó‡∏∏‡∏Å‡πÄ‡∏î‡∏∑‡∏≠‡∏ô ‡∏ï‡πâ‡∏≠‡∏á‡∏ô‡∏±‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ã‡πâ‡∏≥‡∏ã‡πâ‡∏≠‡∏ô

### ‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢
‡∏™‡∏£‡πâ‡∏≤‡∏á Web Application ‡∏ó‡∏µ‡πà:
- **‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•** ‡∏Å‡∏≤‡∏£ counseling ‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢‡πÑ‡∏î‡πâ‡∏á‡πà‡∏≤‡∏¢‡∏ú‡πà‡∏≤‡∏ô ‡∏Ñ‡∏≠‡∏°/‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠/‡πÑ‡∏≠‡πÅ‡∏û‡∏î (responsive)
- **Dashboard & KPI** ‡πÅ‡∏ö‡∏ö real-time ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ä‡πà‡∏ß‡∏á‡πÄ‡∏ß‡∏•‡∏≤/‡πÄ‡∏î‡∏∑‡∏≠‡∏ô/‡∏õ‡∏µ‡∏á‡∏ö‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì‡πÑ‡∏î‡πâ
- **Export ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô** ‡πÄ‡∏õ‡πá‡∏ô Excel ‡∏ó‡∏µ‡πà format ‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö template ‡∏ó‡∏µ‡πà‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏á‡∏≤‡∏ô‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£
- **‡∏•‡∏î‡πÄ‡∏ß‡∏•‡∏≤** ‡∏à‡∏≤‡∏Å‡∏Å‡∏≤‡∏£‡∏à‡∏î‚Üí‡∏Ñ‡∏µ‡∏¢‡πå‚Üí‡∏ô‡∏±‡∏ö manual ‚Üí ‡πÄ‡∏õ‡πá‡∏ô ‡∏à‡∏¥‡πâ‡∏°‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‚Üí‡∏î‡∏π‡∏ú‡∏•‡∏ó‡∏±‡∏ô‡∏ó‡∏µ

---

## 2. üë• User Roles & Access

### ‡πÉ‡∏ä‡πâ RBAC ‡∏ó‡∏µ‡πà‡∏°‡∏µ‡πÉ‡∏ô Template (lib/role-helpers.ts)

| Role | ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå |
|------|-------|
| **USER** (‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏ó‡∏µ‡πà‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥)|
| **ADMIN** (‡πÄ‡∏†‡∏™‡∏±‡∏ä‡∏Å‡∏£) | ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• C/L, ‡∏î‡∏π Dashboard ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏±‡∏ß‡πÄ‡∏≠‡∏á, ‡∏î‡∏π‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢ |
| **SUPERADMIN** (‡∏´‡∏±‡∏ß‡∏´‡∏ô‡πâ‡∏≤‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏á‡∏≤‡∏ô) | ‡∏î‡∏π Dashboard ‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°, Export ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô, ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á, ‡∏î‡∏π‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏†‡∏™‡∏±‡∏ä‡∏Å‡∏£‡∏ó‡∏∏‡∏Å‡∏Ñ‡∏ô ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£ users, system config ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î |

---

## 3. üìä Database Schema Design

### 3.1 Patient Registry (‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢ ‚Äî ‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡∏à‡∏≤‡∏Å sheet "Reg. pt")

```prisma
model Patient {
  id            String    @id @default(cuid())
  hn            String    @unique              // Hospital Number ‚Äî PK ‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö HIS
  prefix        String?                         // ‡∏Ñ‡∏≥‡∏ô‡∏≥‡∏´‡∏ô‡πâ‡∏≤: ‡∏ô‡∏≤‡∏¢, ‡∏ô‡∏≤‡∏á, ‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß, ‡πÄ‡∏î‡πá‡∏Å‡∏ä‡∏≤‡∏¢, ‡πÄ‡∏î‡πá‡∏Å‡∏´‡∏ç‡∏¥‡∏á
  firstName     String
  lastName      String
  gender        Gender                          // M, F
  dateOfBirth   DateTime?
  
  // Clinical status
  caseType      CaseType  @default(NEW)         // NEW = New case, OLD = Old case (Follow-up)
  status        PatientStatus @default(ACTIVE)   // ACTIVE, DISCHARGED, REFERRED, DECEASED
  
  // ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå
  healthScheme  HealthScheme                    // UC, ‡∏õ‡∏Å‡∏™., ‡∏Ç‡∏£‡∏Å./‡∏ó‡πâ‡∏≠‡∏á‡∏ñ‡∏¥‡πà‡∏ô, ‡∏≠‡∏∑‡πà‡∏ô‡πÜ
  
  // Diagnosis ‚Äî ‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢ 1 ‡∏Ñ‡∏ô ‡∏≠‡∏≤‡∏à‡∏°‡∏µ‡∏°‡∏≤‡∏Å‡∏Å‡∏ß‡πà‡∏≤ 1 Dx
  diagnoses     PatientDiagnosis[]
  
  // Clinic info
  newClinicDate DateTime?                       // ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏°‡∏≤‡∏Ñ‡∏•‡∏¥‡∏ô‡∏¥‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡πÅ‡∏£‡∏Å
  referDate     DateTime?                       // ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà refer/discharge
  referNote     String?
  
  // Relations
  counselingRecords CounselingRecord[]
  
  createdAt     DateTime  @default(now())
  updatedAt     DateTime  @updatedAt
  createdBy     String                          // userId ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏ô‡∏™‡∏£‡πâ‡∏≤‡∏á
  
  @@index([hn])
  @@index([lastName, firstName])
  @@map("patients")
}

enum Gender {
  M
  F
}

enum CaseType {
  NEW
  OLD
}

enum PatientStatus {
  ACTIVE
  DISCHARGED
  REFERRED
  DECEASED
}

enum HealthScheme {
  UC                  // ‡∏ö‡∏±‡∏ï‡∏£‡∏ó‡∏≠‡∏á
  SSS                 // ‡∏õ‡∏£‡∏∞‡∏Å‡∏±‡∏ô‡∏™‡∏±‡∏á‡∏Ñ‡∏°
  CSMBS               // ‡∏Ç‡∏£‡∏Å./‡∏ó‡πâ‡∏≠‡∏á‡∏ñ‡∏¥‡πà‡∏ô (Civil Servant Medical Benefit Scheme)
  OTHER               // ‡∏≠‡∏∑‡πà‡∏ô‡πÜ
}
```

### 3.2 Patient Diagnosis (‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡∏à‡∏≤‡∏Å column "Dx")

```prisma
model PatientDiagnosis {
  id          String   @id @default(cuid())
  patientId   String
  patient     Patient  @relation(fields: [patientId], references: [id], onDelete: Cascade)
  diagnosis   RheuDiagnosis
  isPrimary   Boolean  @default(false)
  diagnosedAt DateTime?
  note        String?
  
  createdAt   DateTime @default(now())
  
  @@index([patientId])
  @@map("patient_diagnoses")
}

enum RheuDiagnosis {
  RA                    // Rheumatoid Arthritis
  SLE                   // Systemic Lupus Erythematosus
  SSC                   // Systemic Sclerosis (Scleroderma)
  UCTD                  // Undifferentiated Connective Tissue Disease
  GOUT                  // Gout
  PSORA                 // Psoriatic Arthritis
  SPA                   // Spondyloarthritis
  OVERLAP_SYNDROME      // Overlap Syndrome
  DERMATOMYOSITIS       // Dermatomyositis
  BEHCETS_DISEASE       // Behcet's Disease
  POLYMYALGIA_RHEUMATICA // Polymyalgia Rheumatica
  OTHER                 // ‡∏≠‡∏∑‡πà‡∏ô‡πÜ
}
```

### 3.3 Counseling Record (‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡∏à‡∏≤‡∏Å sheet "‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏Ñ‡∏µ‡∏¢‡πå‡∏à‡∏≤‡∏Å‡∏á‡∏≤‡∏ôCL" ‚Äî 1 row = 1 record)

**‡∏ô‡∏µ‡πà‡∏Ñ‡∏∑‡∏≠ table ‡∏´‡∏•‡∏±‡∏Å‡∏ó‡∏µ‡πà‡πÄ‡∏†‡∏™‡∏±‡∏ä‡∏Å‡∏£‡∏à‡∏∞‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡πà‡∏≤‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡∏ü‡∏≠‡∏£‡πå‡∏°**

```prisma
model CounselingRecord {
  id              String    @id @default(cuid())
  
  // === ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô ===
  date            DateTime                      // ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏ó‡∏≥ C/L (DD/MM/YYYY)
  sequenceNumber  Int?                          // ‡∏•‡∏≥‡∏î‡∏±‡∏ö‡πÉ‡∏ô‡∏ß‡∏±‡∏ô‡∏ô‡∏±‡πâ‡∏ô
  patientId       String
  patient         Patient   @relation(fields: [patientId], references: [id])
  pharmacistId    String                        // userId ‡∏Ç‡∏≠‡∏á‡πÄ‡∏†‡∏™‡∏±‡∏ä‡∏Å‡∏£‡∏ó‡∏µ‡πà‡∏ó‡∏≥
  pharmacist      User      @relation(fields: [pharmacistId], references: [id])
  counselingType  CounselingType                // PRE or POST
  
  // === ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏¢‡∏≤ ===
  currentDmards   String?                       // ‡∏¢‡∏≤ DMARDs ‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡∏≠‡∏¢‡∏π‡πà (text, ‡πÄ‡∏ä‡πà‡∏ô "MTX, HCQ, Pred")
  hasDmards       Boolean   @default(false)     // ‡∏°‡∏µ DMARDs ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà
  otherMeds       String?                       // ‡∏¢‡∏≤‡∏≠‡∏∑‡πà‡∏ô‡πÜ
  
  // === ‡∏ã‡∏±‡∏Å‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥ ===
  historyNote     String?                       // Note ‡∏à‡∏≤‡∏Å‡∏Å‡∏≤‡∏£‡∏ã‡∏±‡∏Å‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥ (free text)
  
  // === ADR (Adverse Drug Reaction) ===
  adrStatus       AdrStatus @default(NO)        // No, Yes ‡∏à‡∏≤‡∏Å DMARD, Yes ‡∏à‡∏≤‡∏Å HQ, Yes ‡∏à‡∏≤‡∏Å‡∏¢‡∏≤‡∏≠‡∏∑‡πà‡∏ô‡πÜ, Yes ‡∏à‡∏≤‡∏Å DMARDs+HQ, Yes ‡∏à‡∏≤‡∏Å DMARDs+‡∏¢‡∏≤‡∏≠‡∏∑‡πà‡∏ô‡πÜ
  adrDescription  String?                       // ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î ADR
  
  // === HQ/CQ Eye Screening (‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏Ñ‡∏ô‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ HQ/CQ) ===
  hasHQ              Boolean  @default(false)   // ‡∏Ñ‡∏ô‡πÑ‡∏Ç‡πâ‡∏°‡∏µ‡πÉ‡∏ä‡πâ‡∏¢‡∏≤ HQ/CQ?
  eyeScreeningStatus String?                    // ‡∏ã‡∏±‡∏Å Eye ‚Üí ‡∏ï‡∏≤‡∏õ‡∏Å‡∏ï‡∏¥, ‡∏°‡∏µ‡∏õ‡∏±‡∏ç‡∏´‡∏≤, ‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏ã‡∏±‡∏Å
  eyeAppointmentStatus EyeAppointmentStatus?    // Yes, No, loss ‡∏ô‡∏±‡∏î EYE, screen ‡∏ó‡∏µ‡πà‡∏£‡∏û.‡∏≠‡∏∑‡πà‡∏ô/‡∏Ñ‡∏•‡∏¥‡∏ô‡∏¥‡∏Å‡∏≠‡∏∑‡πà‡∏ô
  consultEyeResult   ConsultEyeResult?          // [if No/loss] Yes = OK consult, No, ‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ suggest ‡∏ô‡∏±‡∏î
  prevEyeDate        DateTime?                  // prev. EYE date
  eyeResult          String?                    // EYE‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î: no maculopathy, maculopathy, etc.
  nextEyeDate        DateTime?                  // next EYE date
  popupHQAction      PopupHQAction?             // set new pop, update pop, ‡∏°‡∏µ pop-up ‡πÄ‡∏î‡∏¥‡∏°, no
  
  // === Compliance / Adherence ===
  complianceStatus   ComplianceStatus            // ‡∏Å‡∏¥‡∏ô‡∏ñ‡∏π‡∏Å+‡∏Ñ‡∏£‡∏ö, non-compliance
  nonComplianceItems NonComplianceItem[]         // ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏õ‡∏±‡∏ç‡∏´‡∏≤ (1-3 ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£)
  
  // === ‡∏¢‡∏≤‡πÄ‡∏´‡∏•‡∏∑‡∏≠ (Leftover medications) ===
  leftoverMeds    String?                       // Text: "ssz=100, losec=30, naproxen=30"
  
  // === Health Behavior ===
  alcoholStatus   String?                       // No, Yes ‡πÄ‡∏ö‡∏µ‡∏¢‡∏£‡πå, Yes ‡πÄ‡∏´‡∏•‡πâ‡∏≤/40, Yes ‡πÄ‡∏ö‡∏µ‡∏¢‡∏£‡πå+‡πÄ‡∏´‡∏•‡πâ‡∏≤, Yes ‡∏ï‡∏≤‡∏°‡πÄ‡∏ó‡∏®‡∏Å‡∏≤‡∏•
  herbStatus      String?                       // No, ‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡πÄ‡∏™‡∏£‡∏¥‡∏°, ‡∏ô‡∏°/‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏ó‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡πÅ‡∏û‡∏ó‡∏¢‡πå
  smokingStatus   String?                       // No, Yes ‡∏ö‡∏∏‡∏´‡∏£‡∏µ‡πà, Yes ‡∏¢‡∏≤‡πÄ‡∏™‡πâ‡∏ô
  nsaidFromOther  String?                       // NSAID ‡∏à‡∏≤‡∏Å‡∏ó‡∏µ‡πà‡∏≠‡∏∑‡πà‡∏ô (free text)
  
  // === DRP (Drug Related Problem) / Consult ===
  hasDrp          Boolean  @default(false)      // ‡∏û‡∏ö DRP?
  drpItems        DrpItem[]                     // ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î DRP (1-2 ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£)
  
  // === Contraception ===
  contraceptionMethod String?                   // ‡∏ß‡∏¥‡∏ò‡∏µ‡∏Ñ‡∏∏‡∏°‡∏Å‡∏≥‡πÄ‡∏ô‡∏¥‡∏î
  
  // === Medication Error ===
  hasME           Boolean  @default(false)      // ‡∏û‡∏ö ME?
  meDescription   String?                       // ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î ME
  meLevel         String?                       // Level: A-G (NCC MERP)
  
  // === Lab Values (‡πÄ‡∏à‡∏≤‡∏∞‡πÅ‡∏•‡∏õ) ===
  labDate         DateTime?                     // ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏à‡∏≤‡∏∞‡πÅ‡∏•‡∏õ
  wbc             Float?                        // WBC (5000-10000 cells/mm3)
  absoluteNeutrophil Float?                     // Absolute Neutrophil Count
  neutrophilPercent  Float?                     // Neutrophil %
  ast             Float?                        // AST (0-31 U/L)
  alt             Float?                        // ALT (0-34 U/L)
  alp             Float?                        // ALP (40-150 U/L)
  uricAcid        Float?                        // Uric acid (3.6-8.2 mg/dL)
  creatinine      Float?                        // Creatinine (0.55-1.02 mg/dL)
  albumin         Float?                        // Albumin (3.5-5.2 gm/dL)
  hsCRP           Float?                        // hsCRP (<1 mg/L)
  labLevel        String?                       // ‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏õ‡∏Å‡∏ï‡∏¥/‡∏ú‡∏¥‡∏î‡∏õ‡∏Å‡∏ï‡∏¥
  
  // === Cyclophosphamide (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ) ===
  hasCyclophosphamide Boolean @default(false)
  cyclophosphamideRoute CyclophosphamideRoute?  // ORAL or IV
  cyclophosphamideCumulativeDose Float?         // Cumulative dose (mg)
  
  // === Other Notes ===
  note            String?                       // Note ‡∏≠‡∏∑‡πà‡∏ô‡πÜ
  
  // === Meta ===
  createdAt       DateTime @default(now())
  updatedAt       DateTime @updatedAt
  
  @@index([date])
  @@index([patientId])
  @@index([pharmacistId])
  @@index([date, pharmacistId])
  @@map("counseling_records")
}

enum CounselingType {
  PRE
  POST
}

enum AdrStatus {
  NO
  YES_DMARD               // Yes ‡∏à‡∏≤‡∏Å DMARD
  YES_HQ                  // Yes ‡∏à‡∏≤‡∏Å HQ
  YES_OTHER               // Yes ‡∏à‡∏≤‡∏Å‡∏¢‡∏≤‡∏≠‡∏∑‡πà‡∏ô‡πÜ
  YES_DMARD_HQ            // Yes ‡∏à‡∏≤‡∏Å DMARDs + HQ
  YES_DMARD_OTHER         // Yes ‡∏à‡∏≤‡∏Å DMARDs + ‡∏¢‡∏≤‡∏≠‡∏∑‡πà‡∏ô‡πÜ
}

enum EyeAppointmentStatus {
  YES                     // ‡∏°‡∏µ‡∏ô‡∏±‡∏î Eye
  NO                      // ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏ô‡∏±‡∏î
  LOSS                    // loss ‡∏ô‡∏±‡∏î EYE
  EXTERNAL_SCREENING      // screen ‡∏ó‡∏µ‡πà‡∏£‡∏û.‡∏≠‡∏∑‡πà‡∏ô/‡∏Ñ‡∏•‡∏¥‡∏ô‡∏¥‡∏Å‡∏≠‡∏∑‡πà‡∏ô
}

enum ConsultEyeResult {
  YES                     // OK consult ‡πÅ‡∏•‡πâ‡∏ß
  NO                      // ‡πÑ‡∏°‡πà
  NOT_SUGGESTED           // ‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ suggest ‡∏ô‡∏±‡∏î
}

enum PopupHQAction {
  SET_NEW                 // set new pop
  UPDATE                  // update pop-up
  EXISTING                // ‡∏°‡∏µ pop-up ‡πÄ‡∏î‡∏¥‡∏°
  NONE                    // no
}

enum ComplianceStatus {
  COMPLIANT               // ‡∏Å‡∏¥‡∏ô‡∏ñ‡∏π‡∏Å+‡∏Ñ‡∏£‡∏ö
  NON_COMPLIANT           // non-compliance
}

enum CyclophosphamideRoute {
  ORAL
  IV
}
```

### 3.4 Non-Compliance Item (‡∏õ‡∏±‡∏ç‡∏´‡∏≤ non-compliance ‚Äî ‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î 3 ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£/‡∏Ñ‡∏£‡∏±‡πâ‡∏á)

```prisma
model NonComplianceItem {
  id                String   @id @default(cuid())
  counselingRecordId String
  counselingRecord   CounselingRecord @relation(fields: [counselingRecordId], references: [id], onDelete: Cascade)
  
  orderNumber       Int                          // 1, 2, or 3
  type              NonComplianceType             // ‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏õ‡∏±‡∏ç‡∏´‡∏≤
  description       String?                       // ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î/‡∏¢‡∏≤‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Ç‡πâ‡∏≠‡∏á
  
  @@index([counselingRecordId])
  @@map("non_compliance_items")
}

enum NonComplianceType {
  WRONG_METHOD          // ‡∏ú‡∏¥‡∏î‡∏ß‡∏¥‡∏ò‡∏µ/‡∏à‡∏≥‡∏ú‡∏¥‡∏î
  FORGOT_DOSE           // ‡∏•‡∏∑‡∏°‡∏Å‡∏¥‡∏ô‡∏¢‡∏≤
  SELF_ADJUST           // ‡∏õ‡∏£‡∏±‡∏ö/‡∏´‡∏¢‡∏∏‡∏î‡∏¢‡∏≤‡πÄ‡∏≠‡∏á
  LOSS_FOLLOWUP         // Loss f/u, ‡∏Ç‡∏≤‡∏î‡∏¢‡∏≤
}
```

### 3.5 DRP Item (Drug Related Problem ‚Äî ‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î 2 ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£/‡∏Ñ‡∏£‡∏±‡πâ‡∏á)

```prisma
model DrpItem {
  id                String   @id @default(cuid())
  counselingRecordId String
  counselingRecord   CounselingRecord @relation(fields: [counselingRecordId], references: [id], onDelete: Cascade)
  
  orderNumber       Int                          // 1 or 2
  drugName          String                       // ‡∏ä‡∏∑‡πà‡∏≠‡∏¢‡∏≤‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Ç‡πâ‡∏≠‡∏á
  drpType           String                       // ‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó DRP (free text ‡∏´‡∏£‡∏∑‡∏≠ enum ‡∏ï‡∏≤‡∏°‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£)
  consultResult     String?                      // ‡∏ú‡∏• consult: accept, not accept, pending
  
  @@index([counselingRecordId])
  @@map("drp_items")
}
```

### 3.6 Drug Saving Record (‡∏°‡∏π‡∏•‡∏Ñ‡πà‡∏≤‡∏¢‡∏≤‡πÄ‡∏´‡∏•‡∏∑‡∏≠ ‚Äî ‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡∏à‡∏≤‡∏Å sheet "Rheu DrugSaving")

```prisma
model DrugSavingRecord {
  id          String   @id @default(cuid())
  month       Int                               // ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô (1-12)
  year        Int                               // ‡∏õ‡∏µ ‡∏Ñ‡∏®. (2025, 2026, ...)
  fiscalYear  String                            // ‡∏õ‡∏µ‡∏á‡∏ö‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì ‡πÄ‡∏ä‡πà‡∏ô "68", "69"
  
  drugCode    String                            // ‡∏£‡∏´‡∏±‡∏™‡∏¢‡∏≤ ‡πÄ‡∏ä‡πà‡∏ô "1M013B"
  drugName    String                            // ‡∏ä‡∏∑‡πà‡∏≠‡∏¢‡∏≤ ‡πÄ‡∏ä‡πà‡∏ô "MTX 2.5 mg tab"
  unitPrice   Float                             // ‡∏£‡∏≤‡∏Ñ‡∏≤‡∏ï‡πà‡∏≠‡πÄ‡∏°‡πá‡∏î/‡∏´‡∏ô‡πà‡∏ß‡∏¢ (‡∏ö‡∏≤‡∏ó)
  quantity    Int                               // ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏°‡πá‡∏î/‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏ó‡∏µ‡πà‡∏ã‡∏±‡∏Å‡∏´‡∏±‡∏Å‡∏¢‡∏≤‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡πÑ‡∏î‡πâ
  totalSaving Float                             // = unitPrice √ó quantity
  
  isDmard     Boolean  @default(false)          // ‡πÄ‡∏õ‡πá‡∏ô‡∏¢‡∏≤‡∏Å‡∏•‡∏∏‡πà‡∏° DMARDs?
  
  createdBy   String                            // userId
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
  
  @@unique([month, year, drugCode])
  @@index([fiscalYear])
  @@index([month, year])
  @@map("drug_saving_records")
}
```

### 3.7 Clinic Session (‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏£‡∏≠‡∏ö‡∏Ñ‡∏•‡∏¥‡∏ô‡∏¥‡∏Å ‚Äî ‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡∏à‡∏≤‡∏Å report row "‡πÑ‡∏î‡πâ‡∏ó‡∏≥‡∏Ñ‡∏•‡∏¥‡∏ô‡∏¥‡∏Å‡∏Å‡∏µ‡πà‡∏Ñ‡∏£‡∏±‡πâ‡∏á")

```prisma
model ClinicSession {
  id                    String   @id @default(cuid())
  date                  DateTime                 // ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏≠‡∏≠‡∏Å‡∏Ñ‡∏•‡∏¥‡∏ô‡∏¥‡∏Å
  month                 Int                      // ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô
  year                  Int                      // ‡∏õ‡∏µ
  fiscalYear            String                   // ‡∏õ‡∏µ‡∏á‡∏ö
  
  totalScheduledPatients Int                     // ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Ñ‡∏ô‡πÑ‡∏Ç‡πâ‡∏ï‡∏≤‡∏°‡∏ô‡∏±‡∏î‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö
  noShowCount           Int     @default(0)      // ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡∏°‡∏≤
  walkInCount           Int     @default(0)      // ‡∏°‡∏≤‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ô‡∏≠‡∏Å‡∏ô‡∏±‡∏î
  postalCount           Int     @default(0)      // ‡∏™‡πà‡∏á‡πÑ‡∏õ‡∏£‡∏©‡∏ì‡∏µ‡∏¢‡πå
  
  pharmacistId          String?                  // ‡πÄ‡∏†‡∏™‡∏±‡∏ä‡∏Å‡∏£‡∏ó‡∏µ‡πà‡∏≠‡∏≠‡∏Å‡∏Ñ‡∏•‡∏¥‡∏ô‡∏¥‡∏Å
  
  note                  String?
  createdBy             String
  createdAt             DateTime @default(now())
  updatedAt             DateTime @updatedAt
  
  @@index([month, year])
  @@index([date])
  @@map("clinic_sessions")
}
```

### 3.8 Drug Master (‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏¢‡∏≤‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á)

```prisma
model DrugMaster {
  id          String   @id @default(cuid())
  drugCode    String   @unique                  // ‡∏£‡∏´‡∏±‡∏™‡∏¢‡∏≤
  drugName    String                            // ‡∏ä‡∏∑‡πà‡∏≠‡∏¢‡∏≤
  unitPrice   Float                             // ‡∏£‡∏≤‡∏Ñ‡∏≤‡∏ï‡πà‡∏≠‡∏´‡∏ô‡πà‡∏ß‡∏¢
  isDmard     Boolean  @default(false)          // ‡πÄ‡∏õ‡πá‡∏ô DMARD?
  isHQ        Boolean  @default(false)          // ‡πÄ‡∏õ‡πá‡∏ô HQ/CQ?
  isActive    Boolean  @default(true)
  
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
  
  @@map("drug_masters")
}
```

---

## 4. üì± UI Pages & Features

### 4.1 ‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏£‡∏Å / Dashboard (‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ó‡∏∏‡∏Å Role)

**Route:** `/dashboard`

‡πÅ‡∏™‡∏î‡∏á overview KPI ‡∏Ç‡∏≠‡∏á‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô (default) ‡∏û‡∏£‡πâ‡∏≠‡∏° date range filter:
- Dropdown ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å: ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô, ‡∏õ‡∏µ‡∏á‡∏ö‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì, ‡∏´‡∏£‡∏∑‡∏≠ custom date range
- Default: ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô

**KPI Cards (‡∏™‡∏£‡∏∏‡∏õ‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°):**
1. ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö counseling (Pre + Post) ‚Üê ‡∏ô‡∏±‡∏ö‡∏à‡∏≤‡∏Å CounselingRecord
2. New vs Old case ratio
3. % Coverage pre-counseling ‚Üê (‡∏à‡∏≥‡∏ô‡∏ß‡∏ô C/L √∑ ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Ñ‡∏ô‡πÑ‡∏Ç‡πâ‡∏ó‡∏µ‡πà‡∏°‡∏≤‡∏Ñ‡∏•‡∏¥‡∏ô‡∏¥‡∏Å)
4. ‡∏û‡∏ö ADE (%‡∏Ç‡∏≠‡∏á‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢ pre)
5. ‡∏õ‡∏±‡∏ç‡∏´‡∏≤ non-compliance (% ‡∏Ç‡∏≠‡∏á‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢ pre)
6. ‡∏°‡∏π‡∏•‡∏Ñ‡πà‡∏≤‡∏¢‡∏≤‡∏ó‡∏µ‡πà‡∏õ‡∏£‡∏∞‡∏´‡∏¢‡∏±‡∏î‡πÑ‡∏î‡πâ (‡∏ö‡∏≤‡∏ó)

**Dashboard Sections (‡πÅ‡∏ï‡πà‡∏•‡∏∞ section ‡πÄ‡∏õ‡πá‡∏ô card/chart):**

#### Section A: ‡∏õ‡∏£‡∏¥‡∏°‡∏≤‡∏ì‡∏á‡∏≤‡∏ô (Workload)
- Bar chart: ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô C/L ‡∏£‡∏≤‡∏¢‡πÄ‡∏î‡∏∑‡∏≠‡∏ô (‡πÅ‡∏¢‡∏Å Pre/Post)
- Pie chart: New vs Old case
- Table: Workload ‡πÄ‡∏†‡∏™‡∏±‡∏ä‡∏Å‡∏£ ‚Äî ‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏†‡∏™‡∏±‡∏ä | ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏Ñ‡∏™ | ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏≠‡∏≠‡∏Å‡∏Ñ‡∏•‡∏¥‡∏ô‡∏¥‡∏Å
- Bar chart: Dx distribution (‡∏Å‡∏µ‡πà‡πÄ‡∏Ñ‡∏™‡∏ï‡πà‡∏≠ Diagnosis)

#### Section B: ‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û (Quality ‚Äî Clinical Outcomes)

**B1: ADE (Adverse Drug Event)**
- Card: ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢‡∏û‡∏ö ADE + %‡∏Ç‡∏≠‡∏á pre-counseling
- Pie chart: ADE ‡πÅ‡∏¢‡∏Å‡∏ï‡∏≤‡∏°‡πÅ‡∏´‡∏•‡πà‡∏á (‡∏à‡∏≤‡∏Å DMARDs, ‡∏à‡∏≤‡∏Å HQ, ‡∏à‡∏≤‡∏Å‡∏¢‡∏≤‡∏≠‡∏∑‡πà‡∏ô‡πÜ, DMARDs+HQ, DMARDs+‡∏¢‡∏≤‡∏≠‡∏∑‡πà‡∏ô‡πÜ)
- Card: WBC < 4,000 (leukopenia) ‡πÉ‡∏ô‡∏Ñ‡∏ô‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ DMARDs ‚Äî ‡∏Å‡∏µ‡πà‡∏Ñ‡∏£‡∏±‡πâ‡∏á

**B2: HQ/CQ Maculopathy Prevention**
- Card: ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô + % ‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢‡∏ó‡∏µ‡πà‡∏°‡∏µ‡πÉ‡∏ä‡πâ‡∏¢‡∏≤ HQ
- Breakdown: 
  - ‡∏°‡∏µ‡∏ô‡∏±‡∏î Eye = Yes / screen ‡∏ó‡∏µ‡πà‡∏£‡∏û.‡∏≠‡∏∑‡πà‡∏ô ‚Üí ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô
  - ‡∏°‡∏µ‡∏ô‡∏±‡∏î Eye = No / loss ‡∏ô‡∏±‡∏î EYE ‚Üí ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô ‚Üí ‡πÉ‡∏ô OK consult EYE = Yes ‡∏Å‡∏µ‡πà‡∏Ñ‡∏ô (%)
- Pie chart: set POP-HQ distribution (set new pop, update pop, ‡∏°‡∏µ pop-up ‡πÄ‡∏î‡∏¥‡∏°, no) + %
- Card: Rx PreC/L suggest HQ screening ‚Üí accept screening % 

**B3: Adherence**
- Card: ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏£‡∏≤‡∏¢ + ‡∏Ñ‡∏£‡∏±‡πâ‡∏á ‡∏ó‡∏µ‡πà‡∏û‡∏ö‡∏õ‡∏±‡∏ç‡∏´‡∏≤ non-compliance + %
- Pie chart: ‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏õ‡∏±‡∏ç‡∏´‡∏≤ non-compliance (‡∏ú‡∏¥‡∏î‡∏ß‡∏¥‡∏ò‡∏µ/‡∏à‡∏≥‡∏ú‡∏¥‡∏î, ‡∏•‡∏∑‡∏°‡∏Å‡∏¥‡∏ô‡∏¢‡∏≤, ‡∏õ‡∏£‡∏±‡∏ö/‡∏´‡∏¢‡∏∏‡∏î‡∏¢‡∏≤‡πÄ‡∏≠‡∏á, Loss f/u ‡∏Ç‡∏≤‡∏î‡∏¢‡∏≤) + %

**B4: Health Behavior**
- Bar chart: Alcohol, Smoking, Herb/Supplement, NSAID ‡∏à‡∏≤‡∏Å‡∏ó‡∏µ‡πà‡∏≠‡∏∑‡πà‡∏ô ‚Äî ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏£‡∏≤‡∏¢

**B5: DRP Consult**
- Card: DRP consult ‡∏Å‡∏µ‡πà‡∏Ñ‡∏£‡∏±‡πâ‡∏á, ‡πÅ‡∏û‡∏ó‡∏¢‡πå accept ‡∏Å‡∏µ‡πà‡∏Ñ‡∏£‡∏±‡πâ‡∏á, % accept
- Card: Medication Error ‚Äî ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Ñ‡∏£‡∏±‡πâ‡∏á, ‡πÅ‡∏¢‡∏Å level

**B6: Cyclophosphamide Monitoring** (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ data)
- Card: ‡∏Å‡∏¥‡∏ô‡∏Å‡∏µ‡πà‡∏Ñ‡∏ô, ‡∏â‡∏µ‡∏î‡∏Å‡∏µ‡πà‡∏Ñ‡∏ô
- Card: Cumulative dose ‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢ + ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô & % ‡∏ó‡∏µ‡πà >36g

#### Section C: ‡∏õ‡∏£‡∏∞‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡∏†‡∏≤‡∏û (Efficiency)
- Card: ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢‡πÄ‡∏Ñ‡∏™‡∏ï‡πà‡∏≠‡πÄ‡∏î‡∏∑‡∏≠‡∏ô = ‡∏£‡∏ß‡∏°‡πÄ‡∏Ñ‡∏™‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î √∑ ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏î‡∏∑‡∏≠‡∏ô
- Table: ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢‡πÄ‡∏Ñ‡∏™‡∏ï‡πà‡∏≠‡πÄ‡∏†‡∏™‡∏±‡∏ä‡∏ï‡πà‡∏≠‡πÄ‡∏î‡∏∑‡∏≠‡∏ô = ‡πÄ‡∏Ñ‡∏™‡πÄ‡∏†‡∏™‡∏±‡∏ä‡∏ô‡∏±‡πâ‡∏ô √∑ ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏≠‡∏≠‡∏Å‡∏Ñ‡∏•‡∏¥‡∏ô‡∏¥‡∏Å‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏ô‡∏±‡πâ‡∏ô
- Card: % Coverage C/L = ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏Ñ‡∏™ C/L √∑ ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Ñ‡∏ô‡πÑ‡∏Ç‡πâ‡∏ó‡∏µ‡πà‡∏°‡∏≤‡∏Ñ‡∏•‡∏¥‡∏ô‡∏¥‡∏Å

#### Section D: ‡∏°‡∏π‡∏•‡∏Ñ‡πà‡∏≤‡∏¢‡∏≤‡πÄ‡∏´‡∏•‡∏∑‡∏≠ (Drug Cost Saving)
- Card: ‡∏°‡∏π‡∏•‡∏Ñ‡πà‡∏≤‡∏£‡∏ß‡∏°‡∏£‡∏≤‡∏¢‡πÄ‡∏î‡∏∑‡∏≠‡∏ô, ‡∏£‡∏≤‡∏¢‡∏õ‡∏µ‡∏á‡∏ö, ‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢‡∏£‡∏≤‡∏¢‡πÄ‡∏î‡∏∑‡∏≠‡∏ô
- Stacked bar chart: ‡∏°‡∏π‡∏•‡∏Ñ‡πà‡∏≤‡πÅ‡∏¢‡∏Å ‡∏¢‡∏≤‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ vs ‡∏¢‡∏≤‡∏Å‡∏•‡∏∏‡πà‡∏° DMARDs
- Card: %‡∏°‡∏π‡∏•‡∏Ñ‡πà‡∏≤‡∏¢‡∏≤‡∏ó‡∏µ‡πà‡∏õ‡∏£‡∏∞‡∏´‡∏¢‡∏±‡∏î‡πÑ‡∏î‡πâ (‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡∏Å‡∏±‡∏ö‡∏°‡∏π‡∏•‡∏Ñ‡πà‡∏≤‡∏¢‡∏≤‡∏ó‡∏µ‡πà‡∏à‡πà‡∏≤‡∏¢‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î ‚Äî ‡∏ñ‡πâ‡∏≤‡∏°‡∏µ denominator)

---

### 4.2 ‡∏´‡∏ô‡πâ‡∏≤‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å Pre-Counseling (‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡∏ö‡πà‡∏≠‡∏¢‡∏™‡∏∏‡∏î)

**Route:** `/counseling/new`

**UX Requirements:**
- **‡∏ï‡πâ‡∏≠‡∏á responsive** ‡πÉ‡∏ä‡πâ‡πÑ‡∏î‡πâ‡∏î‡∏µ‡∏ö‡∏ô iPad / ‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠
- **‡πÄ‡∏£‡πá‡∏ß ‡∏á‡πà‡∏≤‡∏¢** ‚Äî ‡πÉ‡∏ä‡πâ dropdown/select ‡πÉ‡∏´‡πâ‡∏°‡∏≤‡∏Å‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î ‡∏•‡∏î free text
- **Conditional fields** ‚Äî ‡∏ã‡πà‡∏≠‡∏ô/‡πÅ‡∏™‡∏î‡∏á field ‡∏ï‡∏≤‡∏°‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç (‡πÄ‡∏ä‡πà‡∏ô Eye screening ‡πÅ‡∏™‡∏î‡∏á‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏Ñ‡∏ô‡∏°‡∏µ HQ)
- **Auto-save** ‡∏´‡∏£‡∏∑‡∏≠ draft mode ‚Äî ‡∏Å‡∏±‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏´‡∏≤‡∏¢
- **Search patient by HN** ‚Äî ‡∏û‡∏¥‡∏°‡∏û‡πå HN ‚Üí auto-fill ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢ (‡∏ñ‡πâ‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡∏Ñ‡∏ô‡πÑ‡∏Ç‡πâ‡πÄ‡∏î‡∏¥‡∏°)

**Form Sections (‡∏ï‡∏≤‡∏°‡∏•‡∏≥‡∏î‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏Å‡∏£‡∏≠‡∏Å‡∏à‡∏£‡∏¥‡∏á):**

#### Section 1: ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô
- **‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà** (date picker, default = ‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ)
- **HN** (text input + search) ‚Üí ‡∏ñ‡πâ‡∏≤‡∏û‡∏ö‡πÉ‡∏ô registry ‚Üí auto-fill ‡∏ä‡∏∑‡πà‡∏≠/Dx/‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå
- **‡∏Ñ‡∏≥‡∏ô‡∏≥‡∏´‡∏ô‡πâ‡∏≤, ‡∏ä‡∏∑‡πà‡∏≠, ‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•** (auto-fill ‡∏´‡∏£‡∏∑‡∏≠‡∏Å‡∏£‡∏≠‡∏Å‡πÉ‡∏´‡∏°‡πà)
- **‡πÄ‡∏†‡∏™‡∏±‡∏ä‡∏Å‡∏£** (auto = ‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ login ‡∏≠‡∏¢‡∏π‡πà)
- **Case** = New / Old (radio button)
- **Dx** (multi-select ‡∏à‡∏≤‡∏Å enum: RA, SLE, SSC, UCTD, Gout, PsorA, SpA, Overlap syndrome, Dermatomyositis, Behcet's disease, Polymyalgia rheumatica, ‡∏≠‡∏∑‡πà‡∏ô‡πÜ)
- **‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå** (select: UC, ‡∏õ‡∏Å‡∏™., ‡∏Ç‡∏£‡∏Å./‡∏ó‡πâ‡∏≠‡∏á‡∏ñ‡∏¥‡πà‡∏ô, ‡∏≠‡∏∑‡πà‡∏ô‡πÜ)

#### Section 2: ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏¢‡∏≤
- **‡∏°‡∏µ DMARDs?** (toggle) ‚Üí ‡∏ñ‡πâ‡∏≤ Yes ‚Üí text input ‡∏ä‡∏∑‡πà‡∏≠‡∏¢‡∏≤ DMARDs
- **‡∏¢‡∏≤‡∏≠‡∏∑‡πà‡∏ô** (text input)

#### Section 3: ‡∏Å‡∏≤‡∏£‡∏ã‡∏±‡∏Å‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥
- **‡∏ã‡∏±‡∏Å‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥** (textarea ‚Äî free text, ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏™‡∏¥‡πà‡∏á‡∏ó‡∏µ‡πà‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢‡πÄ‡∏•‡πà‡∏≤)

#### Section 4: ADR Assessment
- **ADR** (select: No, Yes ‡∏à‡∏≤‡∏Å DMARD, Yes ‡∏à‡∏≤‡∏Å HQ, Yes ‡∏à‡∏≤‡∏Å‡∏¢‡∏≤‡∏≠‡∏∑‡πà‡∏ô‡πÜ, Yes ‡∏à‡∏≤‡∏Å DMARDs+HQ, Yes ‡∏à‡∏≤‡∏Å DMARDs+‡∏¢‡∏≤‡∏≠‡∏∑‡πà‡∏ô‡πÜ)
- **‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢ ADR** (textarea ‚Äî ‡πÅ‡∏™‡∏î‡∏á‡πÄ‡∏°‡∏∑‡πà‡∏≠ ADR ‚â† No)

#### Section 5: HQ/CQ Eye Screening *(conditional: ‡πÅ‡∏™‡∏î‡∏á‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡πÄ‡∏°‡∏∑‡πà‡∏≠ ‡∏°‡∏µ HQ = true)*
- **‡∏ã‡∏±‡∏Å Eye** (text note)
- **‡∏°‡∏µ‡∏ô‡∏±‡∏î Eye ‡∏¢‡∏±‡∏á?** (select: Yes, No, loss ‡∏ô‡∏±‡∏î EYE, screen ‡∏ó‡∏µ‡πà‡∏£‡∏û.‡∏≠‡∏∑‡πà‡∏ô/‡∏Ñ‡∏•‡∏¥‡∏ô‡∏¥‡∏Å‡∏≠‡∏∑‡πà‡∏ô)
- *[if No / loss]*: **OK consult EYE** (select: Yes, No, ‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ suggest ‡∏ô‡∏±‡∏î)
- **prev. EYE date** (date picker)
- **EYE‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î** (text: no maculopathy, maculopathy, etc.)
- **next EYE date** (date picker)
- **set POP-HQ** (select: set new pop, update pop-up, ‡∏°‡∏µ pop-up ‡πÄ‡∏î‡∏¥‡∏°, no)

#### Section 6: Compliance
- **‡∏Å‡∏¥‡∏ô‡∏¢‡∏≤** (radio: ‡∏Å‡∏¥‡∏ô‡∏ñ‡∏π‡∏Å+‡∏Ñ‡∏£‡∏ö / non-compliance)
- *[if non-compliance]*: **‡∏õ‡∏±‡∏ç‡∏´‡∏≤ non-compliance** (repeatable, max 3):
  - **‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó** (select: ‡∏ú‡∏¥‡∏î‡∏ß‡∏¥‡∏ò‡∏µ/‡∏à‡∏≥‡∏ú‡∏¥‡∏î, ‡∏•‡∏∑‡∏°‡∏Å‡∏¥‡∏ô‡∏¢‡∏≤, ‡∏õ‡∏£‡∏±‡∏ö/‡∏´‡∏¢‡∏∏‡∏î‡∏¢‡∏≤‡πÄ‡∏≠‡∏á, Loss f/u ‡∏Ç‡∏≤‡∏î‡∏¢‡∏≤)
  - **‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î** (text ‚Äî ‡∏£‡∏∞‡∏ö‡∏∏‡∏¢‡∏≤‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏´‡∏ï‡∏∏‡∏ú‡∏•)

#### Section 7: ‡∏¢‡∏≤‡πÄ‡∏´‡∏•‡∏∑‡∏≠
- **‡∏¢‡∏≤‡πÄ‡∏´‡∏•‡∏∑‡∏≠** (text ‚Äî format: "‡∏¢‡∏≤=‡∏à‡∏≥‡∏ô‡∏ß‡∏ô, ‡∏¢‡∏≤=‡∏à‡∏≥‡∏ô‡∏ß‡∏ô" ‡πÄ‡∏ä‡πà‡∏ô "folic=80, HQ=30, MTX=20")
  - *Note: ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ô‡∏µ‡πâ‡∏à‡∏∞‡πÑ‡∏õ‡πÉ‡∏ä‡πâ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì Drug Saving ‡∏ï‡πà‡∏≠*

#### Section 8: ‡∏û‡∏§‡∏ï‡∏¥‡∏Å‡∏£‡∏£‡∏°‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û
- **Alcohol** (select: No, Yes ‡πÄ‡∏ö‡∏µ‡∏¢‡∏£‡πå, Yes ‡πÄ‡∏´‡∏•‡πâ‡∏≤, Yes ‡πÄ‡∏ö‡∏µ‡∏¢‡∏£‡πå+‡πÄ‡∏´‡∏•‡πâ‡∏≤, Yes ‡∏ï‡∏≤‡∏°‡πÄ‡∏ó‡∏®‡∏Å‡∏≤‡∏•)
- **Herb/Supplement** (select: No, ‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡πÄ‡∏™‡∏£‡∏¥‡∏°, ‡∏ô‡∏°/‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏ó‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡πÅ‡∏û‡∏ó‡∏¢‡πå)
- **Smoking** (select: No, Yes ‡∏ö‡∏∏‡∏´‡∏£‡∏µ‡πà, Yes ‡∏¢‡∏≤‡πÄ‡∏™‡πâ‡∏ô)
- **NSAID ‡∏à‡∏≤‡∏Å‡∏ó‡∏µ‡πà‡∏≠‡∏∑‡πà‡∏ô** (text)

#### Section 9: DRP / Consult
- **‡∏û‡∏ö DRP?** (toggle)
- *[if Yes]*: **‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î DRP** (repeatable, max 2):
  - **‡∏¢‡∏≤** (text)
  - **DRPs ‡πÅ‡∏ö‡∏ö‡πÉ‡∏î** (text)
  - **‡∏ú‡∏• consult** (select: accept, not accept, pending)

#### Section 10: ‡∏≠‡∏∑‡πà‡∏ô‡πÜ
- **‡∏ß‡∏¥‡∏ò‡∏µ‡∏Ñ‡∏∏‡∏°‡∏Å‡∏≥‡πÄ‡∏ô‡∏¥‡∏î** (text)
- **ME** (toggle) ‚Üí **‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î ME** (text) ‚Üí **ME Level** (select A-G)
- **Note ‡∏≠‡∏∑‡πà‡∏ô‡πÜ** (textarea)

#### Section 11: Lab Values (optional ‚Äî ‡∏Å‡∏£‡∏≠‡∏Å‡∏ñ‡πâ‡∏≤‡∏°‡∏µ)
- **‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏à‡∏≤‡∏∞‡πÅ‡∏•‡∏õ** (date picker)
- **WBC, ANC, Neutrophil %, AST, ALT, ALP, Uric acid, Creatinine, Albumin, hsCRP** (number inputs)

#### Section 12: Cyclophosphamide (conditional ‚Äî ‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏Ñ‡∏ô‡∏ó‡∏µ‡πà‡∏°‡∏µ)
- **‡πÑ‡∏î‡πâ Cyclophosphamide?** (toggle)
- **Route** (select: ‡∏Å‡∏¥‡∏ô/‡∏â‡∏µ‡∏î)
- **Cumulative dose (mg)** (number)

**Action Buttons:**
- üíæ **‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å** (submit)
- üìã **‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å & ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡∏°‡πà** (submit ‚Üí reset form ‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏î‡∏¥‡∏°)
- üóëÔ∏è **‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å** (discard)

---

### 4.3 ‡∏´‡∏ô‡πâ‡∏≤‡∏î‡∏π‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£ Counseling Records

**Route:** `/counseling`

- **Table view** ‡πÅ‡∏™‡∏î‡∏á‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£ counseling records
- Filter: ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà, ‡πÄ‡∏†‡∏™‡∏±‡∏ä‡∏Å‡∏£, HN, Dx
- Click ‚Üí ‡∏î‡∏π‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î / ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç
- Bulk export to Excel

---

### 4.4 ‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢

**Route:** `/patients`

- ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏î‡πâ‡∏ß‡∏¢ HN, ‡∏ä‡∏∑‡πà‡∏≠, ‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•
- ‡∏î‡∏π profile ‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢ + ‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥ counseling ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
- ‡πÄ‡∏û‡∏¥‡πà‡∏°/‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢

---

### 4.5 ‡∏´‡∏ô‡πâ‡∏≤‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ñ‡∏•‡∏¥‡∏ô‡∏¥‡∏Å (Clinic Session)

**Route:** `/clinic-sessions`

- ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏£‡∏≠‡∏ö‡∏Ñ‡∏•‡∏¥‡∏ô‡∏¥‡∏Å‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏ß‡∏±‡∏ô: ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Ñ‡∏ô‡πÑ‡∏Ç‡πâ‡∏ô‡∏±‡∏î, ‡πÑ‡∏°‡πà‡∏°‡∏≤, ‡∏°‡∏≤‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ô‡∏≠‡∏Å‡∏ô‡∏±‡∏î, ‡∏™‡πà‡∏á‡∏õ‡∏ì.
- ‡πÉ‡∏ä‡πâ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì % Coverage

---

### 4.6 ‡∏´‡∏ô‡πâ‡∏≤‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏°‡∏π‡∏•‡∏Ñ‡πà‡∏≤‡∏¢‡∏≤‡πÄ‡∏´‡∏•‡∏∑‡∏≠ (Drug Saving)

**Route:** `/drug-saving`

- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏î‡∏∑‡∏≠‡∏ô/‡∏õ‡∏µ
- Table: ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏¢‡∏≤ | ‡∏£‡∏≤‡∏Ñ‡∏≤‡∏ï‡πà‡∏≠‡πÄ‡∏°‡πá‡∏î | ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏´‡∏•‡∏∑‡∏≠ | ‡∏°‡∏π‡∏•‡∏Ñ‡πà‡∏≤
- ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏¢‡∏≤‡∏à‡∏≤‡∏Å Drug Master
- Auto-calculate saving = ‡∏£‡∏≤‡∏Ñ‡∏≤ √ó ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô
- Summary: ‡∏£‡∏ß‡∏°‡∏°‡∏π‡∏•‡∏Ñ‡πà‡∏≤ DMARDs vs ‡∏¢‡∏≤‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ

---

### 4.7 ‡∏´‡∏ô‡πâ‡∏≤ Export ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô

**Route:** `/reports`

- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏õ‡∏µ‡∏á‡∏ö‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì / ‡∏ä‡πà‡∏ß‡∏á‡πÄ‡∏î‡∏∑‡∏≠‡∏ô
- Export ‡πÄ‡∏õ‡πá‡∏ô Excel (.xlsx) ‡πÉ‡∏ô‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡∏±‡∏ö sheet "report‡∏™‡πà‡∏á‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏á‡∏≤‡∏ô"
- ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö‡∏î‡πâ‡∏ß‡∏¢ (auto-calculate ‡∏à‡∏≤‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö):

**‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô Excel (‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡∏à‡∏≤‡∏Å template ‡πÄ‡∏î‡∏¥‡∏°):**

```
‡∏™‡∏£‡∏∏‡∏õ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏á‡∏≤‡∏ô‡∏ö‡∏£‡∏¥‡∏ö‡∏≤‡∏•‡πÄ‡∏†‡∏™‡∏±‡∏ä‡∏Å‡∏£‡∏£‡∏°‡∏Ñ‡∏•‡∏¥‡∏ô‡∏¥‡∏Å‡πÇ‡∏£‡∏Ñ‡∏Ç‡πâ‡∏≠‡∏£‡∏π‡∏°‡∏≤‡∏ï‡∏¥‡∏ã‡∏±‡∏°
‡∏õ‡∏µ‡∏á‡∏ö‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì ____

                                  | ‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢ | ‡∏ï‡∏Ñ | ‡∏û‡∏¢ | ‡∏ò‡∏Ñ | ... | ‡∏Å‡∏¢ | ‡∏£‡∏ß‡∏°‡∏õ‡∏µ‡∏á‡∏ö
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
‡πÑ‡∏î‡πâ‡∏ó‡∏≥‡∏Ñ‡∏•‡∏¥‡∏ô‡∏¥‡∏Å‡∏Å‡∏µ‡πà‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏à‡∏≤‡∏Å‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î        |          | x/y | x/y | ...
‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Ñ‡∏ô‡πÑ‡∏Ç‡πâ‡∏ï‡∏≤‡∏°‡∏ô‡∏±‡∏î‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö (‡∏û‡∏∏‡∏ò)       |          | 515 | 551 | ...
‡πÑ‡∏°‡πà‡∏°‡∏≤                              |          | 68  | 63  | ...
‡∏°‡∏≤‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ô‡∏≠‡∏Å‡∏ô‡∏±‡∏î                       |          | ... | ...
‡∏™‡πà‡∏á‡∏õ‡∏ì.                             |          | 294 | 234 | ...
‡πÄ‡∏õ‡πâ‡∏≤‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢‡∏Ñ‡∏•‡∏¥‡∏ô‡∏¥‡∏Å Rheu              |          | ... | ...  
‡πÄ‡∏õ‡πâ‡∏≤‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢‡∏°‡∏≤‡∏Ñ‡∏•‡∏¥‡∏ô‡∏¥‡∏Å Rheu             |          | ... | ...

pre-counseling                     | ‡∏ï‡∏≤‡∏°‡∏à‡∏£‡∏¥‡∏á   | 108 | 112 | ...
%coverage pre-counseling           | ‚â•60%     | 24.2| 23.0| ...
post-counseling                    | ‡∏ï‡∏≤‡∏°‡∏à‡∏£‡∏¥‡∏á   | 1   | 0   | ...
‡∏£‡∏ß‡∏°‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡πÉ‡∏´‡πâ‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£ (Pre & Post)  | ‡∏ï‡∏≤‡∏°‡∏à‡∏£‡∏¥‡∏á   | 109 | 112 | ...

Clinical outcome I: ADE
‡∏û‡∏ö ADE (‡∏£‡∏≤‡∏¢)                       | ‡∏ï‡∏≤‡∏°‡∏à‡∏£‡∏¥‡∏á   | 20  | 14  | ...
‡∏Ñ‡∏¥‡∏î‡πÄ‡∏õ‡πá‡∏ô% (‡∏Ç‡∏≠‡∏á‡∏ú‡∏õ pre)               | ‡∏ï‡∏≤‡∏°‡∏à‡∏£‡∏¥‡∏á   | 18.5| 12.5| ...
ADE leukopenia (WBC<4,000)        | ‡∏î‡∏∂‡∏á HomC  | 8   | 2   | ...
- ‡∏à‡∏≤‡∏Å DMARDs                       |          | 13  | 9   | ...
- ‡∏à‡∏≤‡∏Å HQ                           |          | 2   | 1   | ...
- ‡∏à‡∏≤‡∏Å‡∏¢‡∏≤‡∏≠‡∏∑‡πà‡∏ô‡πÜ                        |          | 4   | 4   | ...

Clinical outcome II: HQ/CQ Maculopathy Prevention
pt on HQ/CQ                        |          | 58  | 33  | ...
%pt on HQ                          |          | 53.2| 29.5| ...
Set pop-up msg-HQ (‡∏Ñ‡∏£‡∏±‡πâ‡∏á)           |          | 45  | 18  | ...
  set new pop                      |          | 24  | 5   | ...
  update pop-up                    |          | 12  | 5   | ...
  ‡∏°‡∏µ pop-up ‡πÄ‡∏î‡∏¥‡∏°                   |          | 9   | 8   | ...
Rx suggest HQ screening            |          | 21  | 3   | ...
accept screening                   |          | 8   | 1   | ...
‡∏Ñ‡∏¥‡∏î‡πÄ‡∏õ‡πá‡∏ô %                          |          | 25.0| 33.3| ...

Adherence
‡∏õ‡∏±‡∏ç‡∏´‡∏≤ non-compliance (‡∏£‡∏≤‡∏¢)          | ‡∏ï‡∏≤‡∏°‡∏à‡∏£‡∏¥‡∏á   | 27  | 34  | ...
‡∏Ñ‡∏¥‡∏î‡πÄ‡∏õ‡πá‡∏ô%                           |          | 25.0| 30.4| ...
‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó non-compliance (‡∏Ñ‡∏£‡∏±‡πâ‡∏á)       |          | 29  | 36  | ...

‡∏û‡∏ö‡πÉ‡∏ä‡πâ NSAID ‡∏¢‡∏≤‡∏ä‡∏∏‡∏î                  |          | 2   | 6   | ...
‡∏û‡∏ö‡πÉ‡∏ä‡πâ Herb/Supplement              |          | 5   | 3   | ...
Smoking                            |          | 3   | 6   | ...
Alcohol                            |          | 6   | 7   | ...

Consult
DRP consult (‡∏Ñ‡∏£‡∏±‡πâ‡∏á)                 | ‡∏ï‡∏≤‡∏°‡∏à‡∏£‡∏¥‡∏á   | 2   | 1   | ...
accept consult                     |          | 2   | 1   | ...
%adherence to intervention         | ‚â•80%     | 100 | 100 | ...

med. cost saving (‡∏ö‡∏≤‡∏ó)             |          |35560|38141| ...

Medication Error
‡∏û‡∏ö dispensing ME                   | ‡πÑ‡∏°‡πà‡∏û‡∏ö E up| ... | ... | ...
```

---

## 5. üîß Technical Implementation Notes

### 5.1 ‡πÉ‡∏ä‡πâ Template ‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏≠‡∏¢‡∏π‡πà

- **Auth**: Better Auth ‡∏ó‡∏µ‡πà setup ‡πÑ‡∏ß‡πâ‡πÅ‡∏•‡πâ‡∏ß ‚Äî ‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô
- **RBAC**: ‡πÉ‡∏ä‡πâ `hasPermission()` ‡∏à‡∏≤‡∏Å `lib/role-helpers.ts`
  - ‡πÄ‡∏û‡∏¥‡πà‡∏° actions ‡πÉ‡∏´‡∏°‡πà: `counseling.create`, `counseling.view_own`, `counseling.view_all`, `patients.manage`, `reports.export`, `drug-saving.manage`, `clinic-session.manage`
- **Security**: ‡πÉ‡∏ä‡πâ Arcjet instances ‡∏ó‡∏µ‡πà‡∏°‡∏µ (‡πÉ‡∏ä‡πâ‡πÅ‡∏Ñ‡πà‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£ login/register)
- **Theme**: ‡πÉ‡∏ä‡πâ semantic design tokens ‡∏ó‡∏µ‡πà‡∏°‡∏µ (Medical Teal = default theme)
- **File Upload**: ‡πÉ‡∏ä‡πâ Vercel Blob ‡∏ó‡∏µ‡πà setup ‡πÑ‡∏ß‡πâ (‡∏ñ‡πâ‡∏≤‡∏à‡∏≥‡πÄ‡∏õ‡πá‡∏ô)

### 5.2 API Routes ‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á

```
POST   /api/counseling              ‚Äî ‡∏™‡∏£‡πâ‡∏≤‡∏á counseling record
GET    /api/counseling              ‚Äî ‡∏î‡∏π‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£ (filter by date, pharmacist, etc.)
GET    /api/counseling/:id          ‚Äî ‡∏î‡∏π‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î record
PATCH  /api/counseling/:id          ‚Äî ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç record
DELETE /api/counseling/:id          ‚Äî ‡∏•‡∏ö record

GET    /api/patients                ‚Äî ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢ (by HN, name)
POST   /api/patients                ‚Äî ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢‡πÉ‡∏´‡∏°‡πà
GET    /api/patients/:id            ‚Äî ‡∏î‡∏π‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢ + ‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥
PATCH  /api/patients/:id            ‚Äî ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢

POST   /api/clinic-sessions         ‚Äî ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å clinic session
GET    /api/clinic-sessions         ‚Äî ‡∏î‡∏π‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£ clinic sessions

POST   /api/drug-saving             ‚Äî ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏°‡∏π‡∏•‡∏Ñ‡πà‡∏≤‡∏¢‡∏≤‡πÄ‡∏´‡∏•‡∏∑‡∏≠
GET    /api/drug-saving             ‚Äî ‡∏î‡∏π‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£ drug saving
PATCH  /api/drug-saving/:id         ‚Äî ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç

GET    /api/drug-master              ‚Äî ‡∏î‡∏π‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏¢‡∏≤ master
POST   /api/drug-master              ‚Äî ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏¢‡∏≤‡πÉ‡∏ô master (Admin)

GET    /api/dashboard/summary       ‚Äî KPI summary (query by date range)
GET    /api/dashboard/workload      ‚Äî Workload data
GET    /api/dashboard/quality       ‚Äî Quality indicators
GET    /api/dashboard/efficiency    ‚Äî Efficiency indicators
GET    /api/dashboard/drug-saving   ‚Äî Drug saving summary

GET    /api/reports/export           ‚Äî Export Excel report
```

### 5.3 Navigation Structure

‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÉ‡∏ô `AppHeader.tsx`:

```typescript
const navItems = [
  { href: "/", label: "Home" },
  { href: "/dashboard", label: "Dashboard", authRequired: true },
  { href: "/counseling/new", label: "‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å C/L", authRequired: true },
  { href: "/counseling", label: "‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£ C/L", authRequired: true },
  { href: "/patients", label: "‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢", authRequired: true },
  { href: "/reports", label: "‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô", authRequired: true, adminOnly: true },
];
```

### 5.4 Thai Fiscal Year Calculation

‡∏õ‡∏µ‡∏á‡∏ö‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì‡πÑ‡∏ó‡∏¢: ‡∏ï‡∏∏‡∏•‡∏≤‡∏Ñ‡∏° ‚Üí ‡∏Å‡∏±‡∏ô‡∏¢‡∏≤‡∏¢‡∏ô
- ‡∏õ‡∏µ‡∏á‡∏ö 68 = ‡∏ï‡∏Ñ 2567 (Oct 2024) ‚Üí ‡∏Å‡∏¢ 2568 (Sep 2025)
- ‡∏õ‡∏µ‡∏á‡∏ö 69 = ‡∏ï‡∏Ñ 2568 (Oct 2025) ‚Üí ‡∏Å‡∏¢ 2569 (Sep 2026)

```typescript
// Helper function
function getThaiFixcalYear(date: Date): string {
  const year = date.getFullYear();
  const month = date.getMonth() + 1; // 1-12
  const buddhistYear = year + 543;
  // ‡∏ñ‡πâ‡∏≤‡πÄ‡∏î‡∏∑‡∏≠‡∏ô ‡∏ï‡∏Ñ-‡∏ò‡∏Ñ = ‡∏õ‡∏µ‡∏á‡∏ö‡πÉ‡∏´‡∏°‡πà
  const fiscalBuddhistYear = month >= 10 ? buddhistYear + 1 : buddhistYear;
  return String(fiscalBuddhistYear).slice(-2); // "68", "69"
}

// ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡πÑ‡∏ó‡∏¢ mapping ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö reports
const thaiMonthAbbr = {
  10: '‡∏ï‡∏Ñ', 11: '‡∏û‡∏¢', 12: '‡∏ò‡∏Ñ',
  1: '‡∏°‡∏Ñ', 2: '‡∏Å‡∏û', 3: '‡∏°‡∏µ‡∏Ñ',
  4: '‡πÄ‡∏°‡∏¢', 5: '‡∏û‡∏Ñ', 6: '‡∏°‡∏¥‡∏¢',
  7: '‡∏Å‡∏Ñ', 8: '‡∏™‡∏Ñ', 9: '‡∏Å‡∏¢'
};
```

### 5.5 Key Computed Metrics (Dashboard Formulas)

```
% Coverage Pre-C/L = (‡∏à‡∏≥‡∏ô‡∏ß‡∏ô pre-counseling √∑ ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢‡∏°‡∏≤‡∏Ñ‡∏•‡∏¥‡∏ô‡∏¥‡∏Å) √ó 100
% ADE = (‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏£‡∏≤‡∏¢ ADE √∑ ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô pre-counseling) √ó 100
% Non-compliance = (‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏£‡∏≤‡∏¢ non-compliance √∑ ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô pre-counseling) √ó 100
% pt on HQ = (‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Ñ‡∏ô‡∏°‡∏µ HQ √∑ ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô pre-counseling) √ó 100
% Accept consult = (accept √∑ DRP consult ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î) √ó 100
‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢‡πÄ‡∏Ñ‡∏™/‡πÄ‡∏†‡∏™‡∏±‡∏ä/‡πÄ‡∏î‡∏∑‡∏≠‡∏ô = ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏Ñ‡∏™‡πÄ‡∏†‡∏™‡∏±‡∏ä‡∏ô‡∏±‡πâ‡∏ô √∑ ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏≠‡∏≠‡∏Å‡∏Ñ‡∏•‡∏¥‡∏ô‡∏¥‡∏Å
‡∏°‡∏π‡∏•‡∏Ñ‡πà‡∏≤‡∏¢‡∏≤‡πÄ‡∏´‡∏•‡∏∑‡∏≠ = Œ£(‡∏£‡∏≤‡∏Ñ‡∏≤‡∏ï‡πà‡∏≠‡πÄ‡∏°‡πá‡∏î √ó ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏°‡πá‡∏î‡πÄ‡∏´‡∏•‡∏∑‡∏≠) ‚Üê ‡πÅ‡∏¢‡∏Å DMARDs vs ‡∏¢‡∏≤‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ
```

---

## 6. üìÇ Data Migration (‡πÄ‡∏≠‡∏≤‡πÑ‡∏ß‡πâ‡∏†‡∏≤‡∏¢‡∏´‡∏•‡∏±‡∏á ‡∏ï‡∏≠‡∏ô‡∏ô‡∏µ‡πâ‡∏ó‡∏≥‡πÄ‡∏õ‡πá‡∏ô‡πÅ‡∏ö‡∏ö New database ‡πÑ‡∏õ‡∏Å‡πà‡∏≠‡∏ô)

### Initial data import ‡∏à‡∏≤‡∏Å Excel ‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô

‡∏Ñ‡∏ß‡∏£‡∏°‡∏µ script ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö import ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å Google Spreadsheet/Excel ‡πÄ‡∏î‡∏¥‡∏°‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡∏∞‡∏ö‡∏ö:

1. **Import Reg. pt** ‚Üí ‡∏™‡∏£‡πâ‡∏≤‡∏á Patient records
2. **Import ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏Ñ‡∏µ‡∏¢‡πå‡∏à‡∏≤‡∏Å‡∏á‡∏≤‡∏ô CL** ‚Üí ‡∏™‡∏£‡πâ‡∏≤‡∏á CounselingRecord + NonComplianceItem + DrpItem
3. **Import Rheu DrugSaving** ‚Üí ‡∏™‡∏£‡πâ‡∏≤‡∏á DrugSavingRecord + DrugMaster
4. **Import report‡∏™‡πà‡∏á‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏á‡∏≤‡∏ô** ‚Üí ‡∏™‡∏£‡πâ‡∏≤‡∏á ClinicSession (‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏£‡∏≠‡∏ö‡∏Ñ‡∏•‡∏¥‡∏ô‡∏¥‡∏Å)

**Mapping ‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç:**
- Column "‡πÄ‡∏†‡∏™‡∏±‡∏ä" ‚Üí match ‡∏Å‡∏±‡∏ö User table (‡∏†.‡∏≠‡∏¥‡πà‡∏°‡∏à‡∏¥‡∏ï ‚Üí pharmacistId)
- Column "HN" ‚Üí match ‡∏Å‡∏±‡∏ö Patient.hn
- ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡πÄ‡∏õ‡πá‡∏ô "-" ‡∏´‡∏£‡∏∑‡∏≠ empty ‚Üí null
- Date format: ‡∏õ‡∏µ ‡∏Ñ‡∏®. (2025, 2026)

---

## 7. ‚úÖ Priority & Phases

### Phase 1 ‚Äî MVP (‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î)
1. ‚òê Database schema (Prisma models)
2. ‚òê Patient registry CRUD
3. ‚òê Counseling form (‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å Pre-C/L)
4. ‚òê Counseling list (‡∏î‡∏π‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£)
5. ‚òê Basic dashboard (KPI cards)

### Phase 2 ‚Äî Dashboard & Reports
6. ‚òê Full dashboard with charts (recharts)
7. ‚òê Date range filter (‡πÄ‡∏î‡∏∑‡∏≠‡∏ô/‡∏õ‡∏µ‡∏á‡∏ö/custom)
8. ‚òê Export Excel report (‡∏ï‡∏≤‡∏° template)
9. ‚òê Clinic session management

### Phase 3 ‚Äî Drug Saving & Enhancement
10. ‚òê Drug saving module
11. ‚òê Drug master management
12. ‚òê Data migration script
13. ‚òê Performance optimization

### Phase 4 ‚Äî Nice-to-Have
14. ‚òê Post-counseling form
15. ‚òê Patient timeline view
16. ‚òê PowerPoint auto-generate (for presentations)
17. ‚òê Push notification / reminder

---

## 8. üìê Design Guidelines

- ‡πÉ‡∏ä‡πâ **semantic design tokens** ‡∏ó‡∏µ‡πà‡∏°‡∏µ‡πÉ‡∏ô template (`bg-surface-primary`, `text-content-primary`, etc.)
- ‡πÉ‡∏ä‡πâ **Shadcn/UI** components ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î (Card, Table, Input, Select, etc.)
- ‡πÉ‡∏ä‡πâ **recharts** ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö chart (‡∏°‡∏µ‡πÉ‡∏ô dependencies ‡πÅ‡∏•‡πâ‡∏ß)
- ‡πÉ‡∏ä‡πâ **framer-motion** ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö animation (‡∏°‡∏µ‡∏≠‡∏¢‡∏π‡πà‡πÅ‡∏•‡πâ‡∏ß)
- ‡πÉ‡∏ä‡πâ **sonner** ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö toast notification
- ‡πÉ‡∏ä‡πâ **react-hook-form + zod** ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö form validation
- ‡∏†‡∏≤‡∏©‡∏≤‡∏´‡∏•‡∏±‡∏Å UI: **‡πÑ‡∏ó‡∏¢** (labels, buttons, messages)
- Responsive: **Mobile-first** ‚Äî ‡∏ï‡πâ‡∏≠‡∏á‡πÉ‡∏ä‡πâ‡πÑ‡∏î‡πâ‡∏î‡∏µ‡∏ö‡∏ô iPad (1024px) ‡πÅ‡∏•‡∏∞‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠ (375px)

---

## 9. üîë Key Column Mapping (Excel ‚Üí Database)

| Excel Column | DB Field | Type | Options/Notes |
|---|---|---|---|
| DD/MM/ ‡∏Ñ‡∏®. | CounselingRecord.date | DateTime | ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà C/L |
| ‡∏•‡∏≥‡∏î‡∏±‡∏ö | CounselingRecord.sequenceNumber | Int | ‡∏•‡∏≥‡∏î‡∏±‡∏ö‡πÉ‡∏ô‡∏ß‡∏±‡∏ô |
| HN | Patient.hn ‚Üí CounselingRecord.patientId | String | FK to Patient |
| ‡∏Ñ‡∏≥‡∏ô‡∏≥‡∏´‡∏ô‡πâ‡∏≤ | Patient.prefix | String | ‡∏ô‡∏≤‡∏¢/‡∏ô‡∏≤‡∏á/‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß |
| ‡∏ä‡∏∑‡πà‡∏≠ | Patient.firstName | String | |
| ‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏• | Patient.lastName | String | |
| ‡πÄ‡∏†‡∏™‡∏±‡∏ä | CounselingRecord.pharmacistId | FK to User | ‡∏†.‡∏≠‡∏¥‡πà‡∏°‡∏à‡∏¥‡∏ï ‚Üí userId |
| Case | Patient.caseType | Enum | New, Old |
| Dx | PatientDiagnosis.diagnosis | Enum | RA, SLE, SSC, UCTD, Gout, PsorA, SpA, Overlap, Dermatomyositis, Behcet's, PMR, ‡∏≠‡∏∑‡πà‡∏ô‡πÜ |
| ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå | Patient.healthScheme | Enum | UC, ‡∏õ‡∏Å‡∏™.(SSS), ‡∏Ç‡∏£‡∏Å./‡∏ó‡πâ‡∏≠‡∏á‡∏ñ‡∏¥‡πà‡∏ô(CSMBS), ‡∏≠‡∏∑‡πà‡∏ô‡πÜ |
| ‡∏°‡∏µ DMARDs? | CounselingRecord.currentDmards + hasDmards | String + Bool | ‡∏ä‡∏∑‡πà‡∏≠‡∏¢‡∏≤ DMARDs |
| ‡∏¢‡∏≤‡∏≠‡∏∑‡πà‡∏ô | CounselingRecord.otherMeds | String | |
| ‡∏ã‡∏±‡∏Å‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥ | CounselingRecord.historyNote | String | free text |
| ADR | CounselingRecord.adrStatus | Enum | No, Yes ‡∏à‡∏≤‡∏Å DMARD, Yes ‡∏à‡∏≤‡∏Å HQ, Yes ‡∏à‡∏≤‡∏Å‡∏¢‡∏≤‡∏≠‡∏∑‡πà‡∏ô‡πÜ |
| ‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢ ADR | CounselingRecord.adrDescription | String | |
| ‡∏ã‡∏±‡∏Å Eye (‡∏Ñ‡∏ô‡∏°‡∏µHQ) | CounselingRecord.eyeScreeningStatus | String | ‡∏ï‡∏≤‡∏õ‡∏Å‡∏ï‡∏¥, ‡∏°‡∏µ‡∏õ‡∏±‡∏ç‡∏´‡∏≤ |
| ‡∏°‡∏µ‡∏ô‡∏±‡∏î Eye ‡∏¢‡∏±‡∏á | CounselingRecord.eyeAppointmentStatus | Enum | Yes, No, loss ‡∏ô‡∏±‡∏î EYE, screen ‡∏ó‡∏µ‡πà‡∏£‡∏û.‡∏≠‡∏∑‡πà‡∏ô |
| [if No] OK consult EYE | CounselingRecord.consultEyeResult | Enum | Yes, No, ‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ suggest ‡∏ô‡∏±‡∏î |
| prev. EYE: D/M/‡∏Ñ‡∏® | CounselingRecord.prevEyeDate | DateTime | |
| EYE‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î | CounselingRecord.eyeResult | String | no maculopathy, etc. |
| next EYE: D/M/‡∏Ñ‡∏® | CounselingRecord.nextEyeDate | DateTime | |
| set POP-HQ | CounselingRecord.popupHQAction | Enum | set new pop, update pop, ‡∏°‡∏µ pop-up ‡πÄ‡∏î‡∏¥‡∏°, no |
| non-compliance? | CounselingRecord.complianceStatus | Enum | ‡∏Å‡∏¥‡∏ô‡∏ñ‡∏π‡∏Å+‡∏Ñ‡∏£‡∏ö(COMPLIANT), non-compliance(NON_COMPLIANT) |
| 1-non-com ‡πÅ‡∏ö‡∏ö‡πÉ‡∏î | NonComplianceItem[0].type | Enum | ‡∏ú‡∏¥‡∏î‡∏ß‡∏¥‡∏ò‡∏µ/‡∏à‡∏≥‡∏ú‡∏¥‡∏î, ‡∏•‡∏∑‡∏°‡∏Å‡∏¥‡∏ô‡∏¢‡∏≤, ‡∏õ‡∏£‡∏±‡∏ö/‡∏´‡∏¢‡∏∏‡∏î‡∏¢‡∏≤‡πÄ‡∏≠‡∏á, Loss f/u ‡∏Ç‡∏≤‡∏î‡∏¢‡∏≤ |
| 1-‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢ NON-Compliance | NonComplianceItem[0].description | String | |
| 2-non-com ‡πÅ‡∏ö‡∏ö‡πÉ‡∏î | NonComplianceItem[1].type | Enum | (same) |
| 2-‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢ NON-Compliance | NonComplianceItem[1].description | String | |
| 3-non-com ‡πÅ‡∏ö‡∏ö‡πÉ‡∏î | NonComplianceItem[2].type | Enum | (same) |
| ‡∏¢‡∏≤‡πÄ‡∏´‡∏•‡∏∑‡∏≠ | CounselingRecord.leftoverMeds | String | "ssz=100, losec=30" |
| Alc | CounselingRecord.alcoholStatus | String | No, Yes ‡πÄ‡∏ö‡∏µ‡∏¢‡∏£‡πå, Yes ‡πÄ‡∏´‡∏•‡πâ‡∏≤/40, Yes ‡πÄ‡∏ö‡∏µ‡∏¢‡∏£‡πå+‡πÄ‡∏´‡∏•‡πâ‡∏≤, Yes ‡∏ï‡∏≤‡∏°‡πÄ‡∏ó‡∏®‡∏Å‡∏≤‡∏• |
| Herb/Supplement | CounselingRecord.herbStatus | String | No, ‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡πÄ‡∏™‡∏£‡∏¥‡∏°, ‡∏ô‡∏°/‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏ó‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡πÅ‡∏û‡∏ó‡∏¢‡πå |
| Smoking | CounselingRecord.smokingStatus | String | No, Yes ‡∏ö‡∏∏‡∏´‡∏£‡∏µ‡πà, Yes ‡∏¢‡∏≤‡πÄ‡∏™‡πâ‡∏ô |
| NSAID ‡∏à‡∏≤‡∏Å‡∏ó‡∏µ‡πà‡∏≠‡∏∑‡πà‡∏ô | CounselingRecord.nsaidFromOther | String | free text |
| DRPs | CounselingRecord.hasDrp | Boolean | Yes ‚Üí true |
| 1-‡∏¢‡∏≤ | DrpItem[0].drugName | String | |
| 1-DRPs ‡πÅ‡∏ö‡∏ö‡πÉ‡∏î | DrpItem[0].drpType | String | |
| 1-‡∏ú‡∏• consult | DrpItem[0].consultResult | String | accept/not accept |
| ‡∏ß‡∏¥‡∏ò‡∏µ‡∏Ñ‡∏∏‡∏°‡∏Å‡∏≥‡πÄ‡∏ô‡∏¥‡∏î | CounselingRecord.contraceptionMethod | String | |
| Note ‡∏≠‡∏∑‡πà‡∏ô‡πÜ | CounselingRecord.note | String | |
| ME | CounselingRecord.hasME | Boolean | |
| ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î ME | CounselingRecord.meDescription | String | |
| ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏à‡∏≤‡∏∞‡πÅ‡∏•‡∏õ | CounselingRecord.labDate | DateTime | |
| WBC | CounselingRecord.wbc | Float | normal: 5000-10000 |
| ANC | CounselingRecord.absoluteNeutrophil | Float | |
| Neutrophil % | CounselingRecord.neutrophilPercent | Float | normal: 35-75% |
| AST | CounselingRecord.ast | Float | normal: 0-31 U/L |
| ALT | CounselingRecord.alt | Float | normal: 0-34 U/L |
| ALP | CounselingRecord.alp | Float | normal: 40-150 U/L |
| Uric acid | CounselingRecord.uricAcid | Float | normal: 3.6-8.2 mg/dL |
| Creatinine | CounselingRecord.creatinine | Float | normal: 0.55-1.02 mg/dL |
| Albumin | CounselingRecord.albumin | Float | normal: 3.5-5.2 gm/dL |
| hsCRP | CounselingRecord.hsCRP | Float | normal: <1 mg/L |
| level | CounselingRecord.labLevel | String | A-G (‡πÉ‡∏ô column A, B, E, C, F, G ‚Üê NCC MERP levels ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö patient assessment) |

---

*‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÇ‡∏î‡∏¢: AI-assisted analysis ‡∏à‡∏≤‡∏Å Google Spreadsheet ‡∏ï‡πâ‡∏ô‡∏â‡∏ö‡∏±‡∏ö + requirement gathering document*
*‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà: ‡∏Å‡∏∏‡∏°‡∏†‡∏≤‡∏û‡∏±‡∏ô‡∏ò‡πå 2569*